---
import BaseLayout from '../../layouts/BaseLayout.astro';
import Breadcrumb from '../../components/Breadcrumb.astro';
import EmailCapture from '../../components/EmailCapture.astro';
import FAQ from '../../components/FAQ.astro';

const breadcrumbs = [
  { name: 'Home', url: '/' },
  { name: 'History & Heritage', url: '/history/' },
];

const pageTitle = 'History & Heritage in Vietnam — From Dynasties to Independence';
const pageDescription = 'From ancient imperial citadels to war tunnels and reunification — trace Vietnam\'s history through the places where it still stands.';

interface TimelineEvent {
  date: string;
  year: number;
  title: string;
  location: string;
  slug?: string | string[];
  description: string;
  whatToSee?: string;
  side: 'left' | 'right';
  era: 'invasion' | 'occupation' | 'liberation' | 'legacy';
}

const timeline: TimelineEvent[] = [
  {
    date: '111 BC – 938 AD',
    year: 111,
    title: 'Chinese Domination',
    location: 'Northern Vietnam',
    slug: 'hanoi',
    description: 'For over a thousand years, Vietnam was under Chinese rule. Despite this, Vietnamese identity persisted through language, customs, and repeated uprisings. The Trung Sisters\' revolt in 40 AD and Ly Bi\'s rebellion in 544 remain symbols of resistance.',
    whatToSee: 'The Trung Sisters\' Temple in Hanoi honors the legendary warriors. The Temple of Literature, founded in 1070, reflects the enduring Vietnamese scholarly tradition.',
    side: 'left',
    era: 'invasion',
  },
  {
    date: '938 AD',
    year: 938,
    title: 'Battle of Bach Dang River — Independence Won',
    location: 'Ha Long Bay Region',
    slug: 'ha-long-bay',
    description: 'Ngo Quyen defeated the Chinese Southern Han fleet by planting iron-tipped wooden stakes in the Bach Dang River. As the tide receded, Chinese ships were impaled and destroyed. This decisive victory ended a millennium of Chinese domination.',
    whatToSee: 'The Bach Dang River is near Ha Long Bay. The victory is commemorated at temples throughout the north.',
    side: 'right',
    era: 'invasion',
  },
  {
    date: '1010 AD',
    year: 1010,
    title: 'Ly Dynasty Founds Thang Long (Hanoi)',
    location: 'Hanoi',
    slug: 'hanoi',
    description: 'Emperor Ly Thai To moved the capital to Thang Long — "Rising Dragon" — on the site of present-day Hanoi. The city would remain Vietnam\'s political center for most of the next millennium.',
    whatToSee: 'The Imperial Citadel of Thang Long is a UNESCO World Heritage Site. Excavations reveal layers of Vietnamese history going back to the 7th century.',
    side: 'left',
    era: 'invasion',
  },
  {
    date: '1802–1945',
    year: 1802,
    title: 'The Nguyen Dynasty — Imperial Vietnam',
    location: 'Hue',
    slug: 'hue',
    description: 'Emperor Gia Long unified Vietnam and established Hue as the imperial capital. The Nguyen Dynasty built the magnificent Imperial City modeled on Beijing\'s Forbidden City. For 143 years, Hue was the center of Vietnamese royal culture, art, and governance.',
    whatToSee: 'The Imperial City, royal tombs of Minh Mang, Tu Duc, and Khai Dinh, and the Perfume River pagodas make Hue one of Vietnam\'s most historically rich destinations.',
    side: 'right',
    era: 'invasion',
  },
  {
    date: '1858–1954',
    year: 1858,
    title: 'French Colonial Period',
    location: 'Ho Chi Minh City',
    slug: 'ho-chi-minh-city',
    description: 'France gradually conquered Vietnam, renaming Saigon and building a colonial infrastructure of grand boulevards, opera houses, and Catholic cathedrals. French Indochina brought railways, coffee plantations, and rubber — but also forced labor and cultural suppression.',
    whatToSee: 'The Notre-Dame Cathedral, Central Post Office (designed by Gustave Eiffel\'s firm), and the Continental Hotel in HCMC are stunning examples of French colonial architecture.',
    side: 'left',
    era: 'occupation',
  },
  {
    date: '1941–1945',
    year: 1941,
    title: 'Japanese Occupation in WWII',
    location: 'Across Vietnam',
    description: 'Japan occupied Vietnam during WWII while maintaining the French colonial administration as a puppet. A devastating famine in 1944-45 killed an estimated 1-2 million Vietnamese — one of the war\'s forgotten tragedies.',
    side: 'right',
    era: 'occupation',
  },
  {
    date: 'September 2, 1945',
    year: 1945,
    title: 'Ho Chi Minh Declares Independence',
    location: 'Hanoi',
    slug: 'hanoi',
    description: 'At Ba Dinh Square in Hanoi, Ho Chi Minh read the Declaration of Independence, quoting Thomas Jefferson. The Democratic Republic of Vietnam was born — but France would not let go without a fight.',
    whatToSee: 'Ba Dinh Square, the Ho Chi Minh Mausoleum, and the Presidential Palace complex in Hanoi mark the birthplace of modern Vietnam.',
    side: 'left',
    era: 'occupation',
  },
  {
    date: 'May 7, 1954',
    year: 1954,
    title: 'Battle of Dien Bien Phu — France Defeated',
    location: 'Dien Bien Phu, Northwest Vietnam',
    description: 'Vietnamese forces under General Vo Nguyen Giap besieged and defeated the French garrison in a remote valley near the Laotian border. The 56-day battle ended French colonial rule in Indochina and divided Vietnam at the 17th parallel.',
    side: 'right',
    era: 'occupation',
  },
  {
    date: '1955–1975',
    year: 1955,
    title: 'The Vietnam War Begins',
    location: 'Across Vietnam',
    slug: 'ho-chi-minh-city',
    description: 'What Americans call the Vietnam War — and Vietnamese call the American War — escalated from advisory missions to full-scale combat. At its peak, over 500,000 US troops were deployed. The conflict would define a generation on both sides.',
    whatToSee: 'The War Remnants Museum in HCMC is one of the most visited museums in Vietnam — unflinching, powerful, and essential viewing.',
    side: 'left',
    era: 'liberation',
  },
  {
    date: '1965–1972',
    year: 1965,
    title: 'Cu Chi Tunnels — Underground Resistance',
    location: 'Ho Chi Minh City',
    slug: 'ho-chi-minh-city',
    description: 'An extraordinary network of tunnels stretching over 250 km beneath the jungles northwest of Saigon. Viet Cong fighters lived, fought, and survived underground for years — right beneath American military bases.',
    whatToSee: 'The Cu Chi Tunnels are a must-visit day trip from HCMC. You can crawl through sections of the tunnels and see the ingenious trap systems and underground living quarters.',
    side: 'right',
    era: 'liberation',
  },
  {
    date: 'January 30, 1968',
    year: 1968,
    title: 'The Tet Offensive',
    location: 'Hue & Across Vietnam',
    slug: 'hue',
    description: 'During the Tet holiday ceasefire, North Vietnamese and Viet Cong forces launched coordinated attacks on over 100 cities. The Battle of Hue — 26 days of brutal urban combat — devastated the Imperial City. The offensive was a military defeat but a political turning point that shifted American public opinion against the war.',
    whatToSee: 'Hue\'s Imperial City still bears battle scars from 1968. The Citadel walls are pockmarked with bullet holes. The flag tower, where the NLF flag flew for 26 days, is a powerful sight.',
    side: 'left',
    era: 'liberation',
  },
  {
    date: '1967–1975',
    year: 1967,
    title: 'The DMZ — Vietnam\'s Dividing Line',
    location: 'Hue (Quang Tri Province)',
    slug: 'hue',
    description: 'The Demilitarized Zone along the 17th parallel divided North and South Vietnam. The area saw some of the war\'s heaviest fighting — Khe Sanh, the Rockpile, and the McNamara Line. More bombs were dropped on Quang Tri province than on all of Europe in WWII.',
    whatToSee: 'DMZ tours from Hue visit the Vinh Moc Tunnels (where entire families lived underground), Khe Sanh Combat Base, and the Hien Luong Bridge that once divided the nation.',
    side: 'right',
    era: 'liberation',
  },
  {
    date: 'April 30, 1975',
    year: 1975,
    title: 'Fall of Saigon — Reunification Day',
    location: 'Ho Chi Minh City',
    slug: 'ho-chi-minh-city',
    description: 'A North Vietnamese tank crashed through the gates of the Independence Palace (now Reunification Palace), ending the war. Saigon was renamed Ho Chi Minh City. The last Americans evacuated by helicopter from the US Embassy rooftop in one of the war\'s most iconic images.',
    whatToSee: 'The Reunification Palace is preserved exactly as it was on April 30, 1975 — including the tank on the front lawn. The former US Embassy site is nearby.',
    side: 'left',
    era: 'liberation',
  },
  {
    date: '1986',
    year: 1986,
    title: 'Doi Moi — Economic Renovation',
    location: 'Across Vietnam',
    description: 'Vietnam launched sweeping economic reforms known as Doi Moi (Renovation), opening the country to foreign investment and private enterprise. The transformation from one of the world\'s poorest nations to a dynamic emerging economy is one of the most remarkable stories of the late 20th century.',
    side: 'right',
    era: 'legacy',
  },
  {
    date: 'Present Day',
    year: 2026,
    title: 'The Heritage That Remains',
    location: 'All Destinations',
    description: 'From Hue\'s Imperial Citadel to the Cu Chi Tunnels, from Hanoi\'s ancient temples to Saigon\'s war museums — Vietnam\'s history is visible everywhere you look. The war ended 50 years ago. The dynasties ended over a century ago. But the places remain, and understanding them transforms how you experience the country.',
    side: 'left',
    era: 'legacy',
  },
];

const eraLabels: Record<string, string> = {
  invasion: 'Ancient Vietnam — 111 BC–1802 AD',
  occupation: 'Colonialism & Revolution — 1858–1954',
  liberation: 'The Vietnam War — 1955–1975',
  legacy: 'Modern Vietnam',
};

const eraGradients: Record<string, string> = {
  invasion: 'linear-gradient(135deg, #B71C1C 0%, #D32F2F 100%)',
  occupation: 'linear-gradient(135deg, #4A5568 0%, #2D3748 100%)',
  liberation: 'linear-gradient(135deg, #1B5E20 0%, #388E3C 100%)',
  legacy: 'linear-gradient(135deg, #0D7377 0%, #4DB6AC 100%)',
};

const eraColors: Record<string, string> = {
  invasion: '#D32F2F',
  occupation: '#718096',
  liberation: '#388E3C',
  legacy: '#0D7377',
};

// Geo coordinates for map markers (from homepage)
const geoLookup: Record<string, { lat: number; lng: number }> = {
  hanoi: { lat: 21.0285, lng: 105.8542 },
  'ha-long-bay': { lat: 20.9101, lng: 107.1839 },
  hue: { lat: 16.4637, lng: 107.5909 },
  'ho-chi-minh-city': { lat: 10.8231, lng: 106.6297 },
};

// Build map markers from timeline events that have slugs
const wwiiMapMarkers = timeline
  .filter(e => e.slug)
  .map(e => {
    const slugs = Array.isArray(e.slug) ? e.slug : [e.slug!];
    const primarySlug = slugs[0];
    const geo = geoLookup[primarySlug];
    if (!geo) return null;
    return {
      lat: geo.lat,
      lng: geo.lng,
      title: e.title,
      date: e.date,
      location: e.location,
      era: e.era,
      color: eraColors[e.era],
      url: `/destinations/${primarySlug}/`,
    };
  })
  .filter(Boolean);

// WW2 card videos — 7 clips cycled across 25 events
const ww2CardVideos = Array.from({ length: 7 }, (_, i) => `/videos/pillar/ww2-card-${i + 1}.mp4`);

---
<BaseLayout
  title={pageTitle}
  description={pageDescription}
  pageType="destination"
  schemaData={{ title: pageTitle, description: pageDescription }}
  breadcrumbs={breadcrumbs}
>
  <!-- Hero -->
  <header class="ww2-hero">
    <video class="ww2-hero-video" autoplay muted loop playsinline preload="metadata">
      <source src="/videos/pillar/history-hero.mp4" type="video/mp4" />
    </video>
    <div class="ww2-hero-gradient"></div>
    <div class="ww2-hero-noise"></div>
    <div class="ww2-hero-content">
      <h1 class="ww2-hero-title">History & Heritage</h1>
      <p class="ww2-hero-subtitle">From ancient dynasties to colonial resistance to reunification — trace Vietnam's history through the places where it still stands.</p>
      <div class="ww2-hero-meta">
        <div class="ww2-hero-meta-item">
          <span class="ww2-hero-meta-label">Events</span>
          <span class="ww2-hero-meta-value">15</span>
        </div>
        <div class="ww2-hero-meta-item">
          <span class="ww2-hero-meta-label">Destinations</span>
          <span class="ww2-hero-meta-value">4</span>
        </div>
        <div class="ww2-hero-meta-item">
          <span class="ww2-hero-meta-label">Timeline</span>
          <span class="ww2-hero-meta-value">111 BC–Today</span>
        </div>
      </div>
    </div>
    <div class="ww2-scroll-hint">Scroll<br />&#8595;</div>
  </header>

  <!-- Breadcrumb -->
  <div class="container-content">
    <Breadcrumb items={breadcrumbs} />
  </div>

  <!-- Personal intro -->
  <section class="ww2-personal reveal">
    <div class="container-content">
      <blockquote class="ww2-personal-quote">
        <p>You can't understand Vietnam without understanding its history. Walking through the Cu Chi Tunnels, standing in the Imperial City of Hue where the Tet Offensive left its scars, visiting the Reunification Palace in Saigon where the war ended — these experiences changed how I see the country. Vietnam's history isn't abstract. It's in the bullet holes in the citadel walls, the tunnel networks beneath the jungle, and the resilience of a people who rebuilt after centuries of foreign domination. I always add heritage sites to my itineraries. They make every other experience in Vietnam deeper.</p>
        <cite>— Scott</cite>
      </blockquote>
    </div>
  </section>

  <!-- View Toggle -->
  <div class="container-content" style="padding-top: var(--space-2); padding-bottom: var(--space-4);">
    <div class="ww2-view-toggle">
      <button class="ww2-toggle-btn active" id="ww2BtnTimeline">Timeline</button>
      <button class="ww2-toggle-btn" id="ww2BtnMap">Map</button>
    </div>
  </div>

  <!-- Timeline -->
  <div id="ww2TimelineView">
  <section class="ww2-timeline-section">
    <div class="container-content">
      <h2 class="ww2-timeline-heading reveal">A History Written in Stone and Spirit</h2>
      <p class="ww2-timeline-sub reveal">Vietnam endured a thousand years of Chinese rule, nearly a century of French colonialism, and decades of devastating war. These are the places where that history is still visible — and still worth understanding.</p>

      <div class="ww2-timeline">
        <div class="ww2-timeline-line" aria-hidden="true"></div>

        {(() => {
          let lastEra = '';
          return timeline.map((event, idx) => {
            const showEra = event.era !== lastEra;
            lastEra = event.era;
            const slugs = Array.isArray(event.slug) ? event.slug : event.slug ? [event.slug] : [];
            const primarySlug = slugs[0];
            const cardVideo = ww2CardVideos[idx % ww2CardVideos.length];
            return (
              <>
                {showEra && (
                  <div class="ww2-era-marker reveal">
                    <div class="ww2-era-pill" style={`background: ${eraGradients[event.era]};`}>
                      {eraLabels[event.era]}
                    </div>
                  </div>
                )}
                <div class={`ww2-event ww2-event--${event.side} reveal`}>
                  <div class="ww2-event-dot" style={`background: ${eraGradients[event.era]};`}></div>
                  {primarySlug && slugs.length === 1 ? (
                    <a href={`/destinations/${primarySlug}/`} class="ww2-event-card">
                      <div class="ww2-event-media" style={`background: ${eraGradients[event.era]};`}>
                        <video class="ww2-event-video" muted loop playsinline preload="none" data-src={cardVideo}></video>
                        <span class="ww2-event-date-badge">{event.date}</span>
                      </div>
                      <div class="ww2-event-body">
                        <h3 class="ww2-event-title">{event.title}</h3>
                        <p class="ww2-event-location">{event.location}</p>
                        <p class="ww2-event-desc">{event.description}</p>
                        {event.whatToSee && (
                          <div class="ww2-event-see">
                            <span class="ww2-event-see-label">What to see today:</span>
                            <p class="ww2-event-see-text">{event.whatToSee}</p>
                          </div>
                        )}
                        <span class="ww2-event-cta">Explore {event.location.split(',')[0]} &rarr;</span>
                      </div>
                      <div class="ww2-event-overlay">
                        <p class="ww2-event-overlay-text">{event.description}</p>
                        {event.whatToSee && (
                          <div class="ww2-event-overlay-see">
                            <span class="ww2-event-overlay-see-label">What to see today:</span>
                            <p>{event.whatToSee}</p>
                          </div>
                        )}
                        <span class="ww2-event-overlay-cta">Explore {event.location.split(',')[0]} &rarr;</span>
                      </div>
                    </a>
                  ) : primarySlug ? (
                    <div class="ww2-event-card ww2-event-card--multi">
                      <div class="ww2-event-media" style={`background: ${eraGradients[event.era]};`}>
                        <video class="ww2-event-video" muted loop playsinline preload="none" data-src={cardVideo}></video>
                        <span class="ww2-event-date-badge">{event.date}</span>
                      </div>
                      <div class="ww2-event-body">
                        <h3 class="ww2-event-title">{event.title}</h3>
                        <p class="ww2-event-location">{event.location}</p>
                        <p class="ww2-event-desc">{event.description}</p>
                        {event.whatToSee && (
                          <div class="ww2-event-see">
                            <span class="ww2-event-see-label">What to see today:</span>
                            <p class="ww2-event-see-text">{event.whatToSee}</p>
                          </div>
                        )}
                        <div class="ww2-event-cta-group">
                          {slugs.map((s) => (
                            <a href={`/destinations/${s}/`} class="ww2-event-cta ww2-event-cta-link">Explore {s.charAt(0).toUpperCase() + s.slice(1)} &rarr;</a>
                          ))}
                        </div>
                      </div>
                    </div>
                  ) : (
                    <div class="ww2-event-card ww2-event-card--nolink">
                      <div class="ww2-event-media" style={`background: ${eraGradients[event.era]};`}>
                        <video class="ww2-event-video" muted loop playsinline preload="none" data-src={cardVideo}></video>
                        <span class="ww2-event-date-badge">{event.date}</span>
                      </div>
                      <div class="ww2-event-body">
                        <h3 class="ww2-event-title">{event.title}</h3>
                        <p class="ww2-event-location">{event.location}</p>
                        <p class="ww2-event-desc">{event.description}</p>
                      </div>
                    </div>
                  )}
                </div>
              </>
            );
          });
        })()}
      </div>
    </div>
  </section>

  </div><!-- /ww2TimelineView -->

  <!-- Map View (hidden by default) -->
  <div id="ww2MapView" style="display:none;">
    <section style="padding: var(--space-4) 0 var(--space-8);">
      <div class="container-content">
        <div class="ww2-map-container" id="ww2MapContainer">
          <div class="ww2-map-tooltip" id="ww2MapTooltip">
            <div class="ww2-map-tooltip-title" id="ww2TooltipTitle"></div>
            <div class="ww2-map-tooltip-date" id="ww2TooltipDate"></div>
            <div class="ww2-map-tooltip-location" id="ww2TooltipLocation"></div>
          </div>
          <div id="ww2LeafletMap"></div>
          <div class="ww2-map-legend">
            <div class="ww2-map-legend-item"><div class="ww2-map-legend-dot" style="background:#D32F2F;"></div>Invasion</div>
            <div class="ww2-map-legend-item"><div class="ww2-map-legend-dot" style="background:#718096;"></div>Occupation</div>
            <div class="ww2-map-legend-item"><div class="ww2-map-legend-dot" style="background:#388E3C;"></div>Liberation</div>
            <div class="ww2-map-legend-item"><div class="ww2-map-legend-dot" style="background:#0D7377;"></div>Legacy</div>
          </div>
        </div>
      </div>
    </section>
  </div>

  <!-- Bottom CTA -->
  <section class="ww2-cta-section reveal">
    <div class="container-content">
      <div class="ww2-cta-card">
        <h2 class="ww2-cta-heading">Plan a Heritage Trip</h2>
        <p class="ww2-cta-text">Tell our AI planner you want a heritage trip and it will build a chronological itinerary — Hue's Imperial City, the Cu Chi Tunnels, the DMZ, and more.</p>
        <a href="/plan/" class="ww2-cta-button">Start Planning &rarr;</a>
      </div>
    </div>
  </section>

  <!-- FAQ -->
  <FAQ items={[
    { question: "What are the most important historical sites in Vietnam?", answer: "The Imperial City in Hue (UNESCO World Heritage Site), the Cu Chi Tunnels near Ho Chi Minh City, the Reunification Palace in Saigon, the Ho Chi Minh Mausoleum complex in Hanoi, the Imperial Citadel of Thang Long (Hanoi), the War Remnants Museum (HCMC), and the DMZ sites near the 17th parallel. Most sites charge 40,000-200,000 VND ($1.60-8 USD) entrance." },
    { question: "Can you visit Vietnam War sites today?", answer: "Yes — Vietnam has preserved many war sites as museums and memorials. The Cu Chi Tunnels are a half-day trip from HCMC. The War Remnants Museum in HCMC is one of the most visited museums in the country. DMZ tours from Hue visit the Vinh Moc Tunnels, Khe Sanh Combat Base, and the former border crossing. The Reunification Palace in HCMC is open daily." },
    { question: "How do I visit the Cu Chi Tunnels?", answer: "The Cu Chi Tunnels are about 70 km northwest of Ho Chi Minh City. You can visit on a half-day tour (typically $15-25 USD) that includes transport, guide, and entrance. There are two sites: Ben Duoc (larger, less crowded) and Ben Dinh (smaller, more touristic). Both let you crawl through sections of the tunnels. Tours depart daily from District 1 hotels." },
    { question: "What is the DMZ tour from Hue?", answer: "The Demilitarized Zone (DMZ) along the 17th parallel divided North and South Vietnam. Full-day tours from Hue (about $40-60 USD) visit the Vinh Moc Tunnels, where entire families lived underground during bombing; the Hien Luong Bridge that once separated the country; the Khe Sanh Combat Base; and Doc Mieu firebase. The drive is about 2 hours each way." },
    { question: "Is it respectful to visit war sites in Vietnam?", answer: "Absolutely — Vietnam has intentionally preserved these sites for education and remembrance. Vietnamese people are remarkably welcoming to American visitors at war sites. The War Remnants Museum presents the Vietnamese perspective and can be emotionally intense but is considered essential viewing. Be respectful, dress modestly at memorial sites, and engage with the history thoughtfully." },
    { question: "What was the Vietnam War?", answer: "Known in Vietnam as the American War (or Resistance War Against America), the conflict lasted from 1955-1975. It involved North Vietnam (supported by the Soviet Union and China) fighting against South Vietnam (supported by the United States). Over 3 million Vietnamese and 58,000 Americans died. The war ended on April 30, 1975 when North Vietnamese forces took Saigon." },
  ]} />

  <!-- Email Capture -->
  <div class="container-content reveal" style="padding-bottom: var(--space-6);">
    <EmailCapture
      leadMagnet="Get Our Free Vietnam Heritage Trail Guide"
      description="A chronological PDF guide to heritage sites across Vietnam — with directions, tour options, and the history behind each location."
      bullets={[
        'All major historical sites with logistics',
        'Cu Chi Tunnels day-trip planner from HCMC',
        'DMZ tour guide from Hue',
        'Suggested 7-day heritage trail itinerary',
      ]}
      guideTag="pillar-history"
    />
  </div>

  <!-- Cross-links -->
  <section class="ww2-crosslinks reveal">
    <div class="container-content">
      <h3 class="ww2-crosslinks-heading">Explore More</h3>
      <div class="ww2-crosslinks-grid">
        <a href="/festivals/" class="ww2-crosslink-card">
          <span class="ww2-crosslink-icon">&#127914;</span>
          <span class="ww2-crosslink-label">Festival Calendar</span>
          <span class="ww2-crosslink-desc">32 festivals across 29 destinations</span>
        </a>
        <a href="/cuisine/" class="ww2-crosslink-card">
          <span class="ww2-crosslink-icon">&#127860;</span>
          <span class="ww2-crosslink-label">Food & Cuisine</span>
          <span class="ww2-crosslink-desc">35 dishes across 3 regions</span>
        </a>
        <a href="/practical/" class="ww2-crosslink-card">
          <span class="ww2-crosslink-icon">&#128218;</span>
          <span class="ww2-crosslink-label">Practical Guide</span>
          <span class="ww2-crosslink-desc">Visa, money & travel tips</span>
        </a>
      </div>
    </div>
  </section>

</BaseLayout>

<!-- Scroll Reveal Observer -->
<script>
  if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
    const revealObserver = new IntersectionObserver(
      (entries) => {
        entries.forEach((e) => {
          if (e.isIntersecting) {
            e.target.classList.add('visible');
          }
        });
      },
      { threshold: 0.1, rootMargin: '0px 0px -40px 0px' }
    );
    document.querySelectorAll('.reveal').forEach((el) => revealObserver.observe(el));
  } else {
    document.querySelectorAll('.reveal').forEach((el) => el.classList.add('visible'));
  }
</script>

<!-- View Toggle Logic -->
<script>
  const ww2BtnTimeline = document.getElementById('ww2BtnTimeline');
  const ww2BtnMap = document.getElementById('ww2BtnMap');
  const ww2TimelineView = document.getElementById('ww2TimelineView');
  const ww2MapView = document.getElementById('ww2MapView');

  function ww2ShowTimeline() {
    ww2TimelineView!.style.display = '';
    ww2MapView!.style.display = 'none';
    ww2BtnTimeline!.classList.add('active');
    ww2BtnMap!.classList.remove('active');
  }

  function ww2ShowMap() {
    ww2TimelineView!.style.display = 'none';
    ww2MapView!.style.display = '';
    ww2BtnTimeline!.classList.remove('active');
    ww2BtnMap!.classList.add('active');
    if (window.ww2Map) {
      window.ww2Map.invalidateSize();
    }
  }

  ww2BtnTimeline?.addEventListener('click', ww2ShowTimeline);
  ww2BtnMap?.addEventListener('click', ww2ShowMap);
</script>

<!-- Lazy-load & autoplay WW2 card videos on scroll -->
<script>
  if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
    const ww2VideoObserver = new IntersectionObserver(
      (entries) => {
        entries.forEach((entry) => {
          const video = entry.target as HTMLVideoElement;
          if (entry.isIntersecting) {
            if (!video.src && video.dataset.src) {
              video.src = video.dataset.src;
            }
            video.play().catch(() => {});
          } else {
            video.pause();
          }
        });
      },
      { rootMargin: '100px' }
    );
    document.querySelectorAll('.ww2-event-video').forEach((v) => ww2VideoObserver.observe(v));
  }
</script>

<!-- Leaflet Map for WWII -->
<script is:inline define:vars={{ markers: wwiiMapMarkers }}>
  // Load Leaflet CSS
  if (!document.getElementById('leaflet-css')) {
    var lnk = document.createElement('link');
    lnk.id = 'leaflet-css';
    lnk.rel = 'stylesheet';
    lnk.href = 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.css';
    document.head.appendChild(lnk);
  }

  function initWwiiMap() {
    var mapEl = document.getElementById('ww2LeafletMap');
    if (!mapEl || typeof L === 'undefined') return;

    var map = L.map(mapEl, {
      center: [12.0, 122.5],
      zoom: 6,
      scrollWheelZoom: false,
      minZoom: 5,
      maxZoom: 12,
      maxBounds: [[4, 115], [22, 130]],
      zoomControl: false,
      attributionControl: false,
    });

    window.ww2Map = map;

    L.control.attribution({ prefix: false }).addTo(map);
    L.control.zoom({ position: 'topright' }).addTo(map);

    L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
      attribution: '\u00a9 <a href="https://www.openstreetmap.org/copyright">OSM</a> \u00a9 <a href="https://carto.com/">CARTO</a>',
      maxZoom: 19,
    }).addTo(map);

    function makeCircle(color, size, stroke) {
      return L.divIcon({
        className: '',
        html: '<div style="width:' + size + 'px;height:' + size + 'px;border-radius:50%;background:' + color + ';border:2px solid ' + stroke + ';box-shadow:0 0 6px rgba(0,0,0,0.3);cursor:pointer;"></div>',
        iconSize: [size, size],
        iconAnchor: [size / 2, size / 2],
      });
    }

    var tooltip = document.getElementById('ww2MapTooltip');
    var tooltipTitle = document.getElementById('ww2TooltipTitle');
    var tooltipDate = document.getElementById('ww2TooltipDate');
    var tooltipLocation = document.getElementById('ww2TooltipLocation');
    var container = document.getElementById('ww2MapContainer');

    markers.forEach(function(m) {
      var icon = makeCircle(m.color, 16, '#ffffff');
      var marker = L.marker([m.lat, m.lng], { icon: icon, title: m.title }).addTo(map);

      marker.on('mouseover', function(e) {
        if (tooltipTitle) tooltipTitle.textContent = m.title;
        if (tooltipDate) tooltipDate.textContent = m.date;
        if (tooltipLocation) tooltipLocation.textContent = m.location;
        if (tooltip) tooltip.classList.add('ww2-tooltip-visible');
        if (container && tooltip) {
          var pt = e.containerPoint;
          tooltip.style.left = (pt.x + 12) + 'px';
          tooltip.style.top = (pt.y - 10) + 'px';
        }
      });

      marker.on('mouseout', function() {
        if (tooltip) tooltip.classList.remove('ww2-tooltip-visible');
      });

      marker.on('click', function() {
        window.location.href = m.url;
      });
    });
  }

  // Load Leaflet JS
  if (typeof L !== 'undefined') {
    initWwiiMap();
  } else {
    var lscript = document.createElement('script');
    lscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.js';
    lscript.onload = initWwiiMap;
    document.head.appendChild(lscript);
  }
</script>

<style>
  /* ================================================================
     HERO — Dark, somber gradient
     ================================================================ */
  .ww2-hero {
    position: relative;
    min-height: 60vh;
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
    padding: 5rem var(--space-6) 60px;
    overflow: hidden;
  }

  .ww2-hero-video {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    z-index: 0;
  }

  .ww2-hero-gradient {
    position: absolute;
    inset: 0;
    z-index: 1;
    background: linear-gradient(to bottom, rgba(0,0,0,0.1) 0%, rgba(0,0,0,0.15) 40%, rgba(0,0,0,0.55) 100%);
  }

  .ww2-hero-noise {
    position: absolute;
    inset: 0;
    z-index: 2;
    background: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.03'/%3E%3C/svg%3E");
    pointer-events: none;
  }

  .ww2-hero-content {
    position: relative;
    z-index: 3;
    max-width: 720px;
  }

  .ww2-hero-title {
    font-size: clamp(2rem, 5vw, 3.2rem);
    font-weight: var(--weight-bold);
    color: #fff;
    line-height: 1.1;
    margin: 0 0 var(--space-3);
  }

  .ww2-hero-subtitle {
    font-size: clamp(1rem, 2vw, 1.15rem);
    color: rgba(255, 255, 255, 0.85);
    line-height: 1.6;
    margin: 0 0 var(--space-5);
    max-width: 580px;
  }

  .ww2-hero-meta {
    display: flex;
    gap: var(--space-5);
    flex-wrap: wrap;
  }

  .ww2-hero-meta-item {
    display: flex;
    flex-direction: column;
    gap: 2px;
  }

  .ww2-hero-meta-label {
    font-size: 0.65rem;
    font-weight: var(--weight-semibold);
    text-transform: uppercase;
    letter-spacing: 0.1em;
    color: rgba(255, 255, 255, 0.5);
  }

  .ww2-hero-meta-value {
    font-size: 1.1rem;
    font-weight: var(--weight-bold);
    color: #fff;
  }

  .ww2-scroll-hint {
    position: absolute;
    bottom: 16px;
    right: var(--space-6);
    z-index: 3;
    font-size: 0.65rem;
    text-transform: uppercase;
    letter-spacing: 0.15em;
    color: rgba(255, 255, 255, 0.35);
    text-align: center;
    animation: ww2Bounce 2s ease-in-out infinite;
  }

  @keyframes ww2Bounce {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(6px); }
  }

  /* ================================================================
     TIMELINE SECTION
     ================================================================ */
  .ww2-timeline-section {
    padding: var(--space-10) 0 var(--space-8);
  }

  .ww2-timeline-heading {
    font-size: clamp(1.5rem, 3vw, 2rem);
    font-weight: var(--weight-bold);
    color: var(--color-deep-night);
    margin: 0 0 var(--space-2);
    text-align: center;
  }

  .ww2-timeline-sub {
    font-size: 1rem;
    color: var(--color-slate);
    text-align: center;
    max-width: 640px;
    margin: 0 auto var(--space-10);
    line-height: 1.6;
  }

  /* Timeline container */
  .ww2-timeline {
    position: relative;
    max-width: 900px;
    margin: 0 auto;
  }

  /* Central vertical line */
  .ww2-timeline-line {
    position: absolute;
    left: 50%;
    top: 0;
    bottom: 0;
    width: 2px;
    background: linear-gradient(to bottom, #B71C1C 0%, #4A5568 40%, #388E3C 75%, #0D7377 100%);
    transform: translateX(-50%);
    opacity: 0.3;
  }

  /* ================================================================
     ERA MARKERS
     ================================================================ */
  .ww2-era-marker {
    position: relative;
    text-align: center;
    margin: var(--space-8) 0 var(--space-6);
    z-index: 2;
  }

  .ww2-era-marker:first-child {
    margin-top: 0;
  }

  .ww2-era-pill {
    display: inline-block;
    font-size: 0.72rem;
    font-weight: var(--weight-bold);
    text-transform: uppercase;
    letter-spacing: 0.1em;
    color: #fff;
    padding: 8px 20px;
    border-radius: 40px;
  }

  /* ================================================================
     TIMELINE EVENT
     ================================================================ */
  .ww2-event {
    position: relative;
    display: flex;
    margin-bottom: var(--space-6);
    padding: 0 var(--space-4);
  }

  .ww2-event--left {
    justify-content: flex-start;
    padding-right: calc(50% + 24px);
  }

  .ww2-event--right {
    justify-content: flex-end;
    padding-left: calc(50% + 24px);
  }

  /* Dot on the timeline */
  .ww2-event-dot {
    position: absolute;
    left: 50%;
    top: 24px;
    width: 14px;
    height: 14px;
    border-radius: 50%;
    transform: translateX(-50%);
    border: 3px solid var(--color-sand);
    z-index: 2;
    box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.06);
  }

  /* Event card */
  .ww2-event-card {
    position: relative;
    display: block;
    background: var(--color-white);
    border: 1px solid rgba(0, 0, 0, 0.06);
    border-radius: 14px;
    overflow: hidden;
    text-decoration: none;
    color: inherit;
    width: 100%;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }

  .ww2-event-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 12px 32px rgba(0, 0, 0, 0.12);
  }

  .ww2-event-card--nolink {
    cursor: default;
    border-style: dashed;
    border-color: rgba(0, 0, 0, 0.12);
  }

  .ww2-event-card--nolink:hover {
    transform: none;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
  }

  .ww2-event-media {
    position: relative;
    aspect-ratio: 21 / 9;
    display: flex;
    align-items: flex-end;
    justify-content: flex-start;
    padding: var(--space-3);
    overflow: hidden;
  }

  .ww2-event-video {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    z-index: 0;
  }

  .ww2-event-date-badge {
    position: relative;
    z-index: 1;
  }

  .ww2-event-date-badge {
    font-size: 0.65rem;
    font-weight: var(--weight-bold);
    text-transform: uppercase;
    letter-spacing: 0.08em;
    color: rgba(255, 255, 255, 0.9);
    background: rgba(0, 0, 0, 0.3);
    backdrop-filter: blur(4px);
    -webkit-backdrop-filter: blur(4px);
    padding: 4px 12px;
    border-radius: 6px;
  }

  .ww2-event-body {
    padding: var(--space-3) var(--space-4) var(--space-5);
  }

  .ww2-event-title {
    font-size: 0.95rem;
    font-weight: var(--weight-bold);
    color: var(--color-deep-night);
    margin: 0 0 4px;
    line-height: 1.25;
  }

  .ww2-event-location {
    font-size: 0.72rem;
    color: var(--color-ocean-teal);
    font-weight: var(--weight-medium);
    margin: 0 0 var(--space-2);
  }

  .ww2-event-desc {
    font-size: 0.78rem;
    color: var(--color-slate);
    line-height: 1.55;
    margin: 0 0 var(--space-3);
  }

  .ww2-event-see {
    background: var(--color-sky);
    border-radius: 8px;
    padding: var(--space-2) var(--space-3);
    margin-bottom: var(--space-3);
  }

  .ww2-event-see-label {
    font-size: 0.65rem;
    font-weight: var(--weight-bold);
    text-transform: uppercase;
    letter-spacing: 0.06em;
    color: var(--color-ocean-teal);
    display: block;
    margin-bottom: 4px;
  }

  .ww2-event-see-text {
    font-size: 0.75rem;
    color: var(--color-slate);
    line-height: 1.5;
    margin: 0;
  }

  .ww2-event-cta {
    font-size: 0.72rem;
    font-weight: var(--weight-semibold);
    color: var(--color-ocean-teal);
  }

  .ww2-event-cta-group {
    display: flex;
    gap: var(--space-3);
    flex-wrap: wrap;
  }

  .ww2-event-cta-link {
    color: var(--color-ocean-teal);
    text-decoration: none;
    transition: color 0.2s ease;
  }

  .ww2-event-cta-link:hover {
    color: var(--color-ocean-teal-dark, #095456);
    text-decoration: underline;
  }

  .ww2-event-card--multi {
    cursor: default;
  }

  .ww2-event-card--multi:hover {
    transform: translateY(-2px);
  }

  /* Hover overlay */
  .ww2-event-overlay {
    position: absolute;
    inset: 0;
    background: rgba(26, 35, 50, 0.94);
    backdrop-filter: blur(6px);
    -webkit-backdrop-filter: blur(6px);
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    padding: var(--space-4);
    opacity: 0;
    transition: opacity 0.3s ease;
    pointer-events: none;
    overflow-y: auto;
  }

  .ww2-event-card:hover .ww2-event-overlay {
    opacity: 1;
    pointer-events: auto;
  }

  .ww2-event-overlay-text {
    font-size: 0.75rem;
    color: rgba(255, 255, 255, 0.92);
    line-height: 1.55;
    margin: 0 0 var(--space-2);
  }

  .ww2-event-overlay-see {
    margin-bottom: var(--space-3);
  }

  .ww2-event-overlay-see-label {
    font-size: 0.6rem;
    font-weight: var(--weight-bold);
    text-transform: uppercase;
    letter-spacing: 0.08em;
    color: rgba(255, 255, 255, 0.5);
    display: block;
    margin-bottom: 4px;
  }

  .ww2-event-overlay-see p {
    font-size: 0.72rem;
    color: rgba(255, 255, 255, 0.75);
    line-height: 1.45;
    margin: 0;
  }

  .ww2-event-overlay-cta {
    font-size: 0.75rem;
    font-weight: var(--weight-semibold);
    color: var(--color-warm-coral);
  }

  /* ================================================================
     RESPONSIVE — Stack timeline on mobile
     ================================================================ */
  @media (max-width: 768px) {
    .ww2-timeline-line {
      left: 20px;
    }

    .ww2-event--left,
    .ww2-event--right {
      padding-left: 48px;
      padding-right: 0;
      justify-content: flex-start;
    }

    .ww2-event-dot {
      left: 20px;
    }

    .ww2-hero {
      min-height: 55vh;
      padding: 0 var(--space-4) 40px;
    }

    .ww2-scroll-hint {
      display: none;
    }
  }

  /* ================================================================
     BOTTOM CTA
     ================================================================ */
  .ww2-cta-section {
    padding: var(--space-6) 0 var(--space-8);
  }

  .ww2-cta-card {
    background: linear-gradient(135deg, var(--color-deep-night) 0%, #2D3748 100%);
    border-radius: 20px;
    padding: var(--space-8) var(--space-6);
    text-align: center;
    color: #fff;
  }

  .ww2-cta-heading {
    font-size: clamp(1.3rem, 3vw, 1.8rem);
    font-weight: var(--weight-bold);
    margin: 0 0 var(--space-3);
    color: #fff;
  }

  .ww2-cta-text {
    font-size: 1rem;
    color: rgba(255, 255, 255, 0.75);
    max-width: 520px;
    margin: 0 auto var(--space-5);
    line-height: 1.6;
  }

  .ww2-cta-button {
    display: inline-block;
    background: var(--color-warm-coral);
    color: #fff;
    font-size: 0.9rem;
    font-weight: var(--weight-semibold);
    padding: 12px 28px;
    border-radius: 40px;
    text-decoration: none;
    transition: background 0.2s ease, transform 0.2s ease;
  }

  .ww2-cta-button:hover {
    background: #d4553b;
    transform: translateY(-2px);
  }

  /* ================================================================
     CROSS-LINKS
     ================================================================ */
  .ww2-crosslinks {
    padding: 0 0 var(--space-10);
  }

  .ww2-crosslinks-heading {
    font-size: 1.1rem;
    font-weight: var(--weight-bold);
    color: var(--color-deep-night);
    text-align: center;
    margin: 0 0 var(--space-4);
  }

  .ww2-crosslinks-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: var(--space-4);
    max-width: 800px;
    margin: 0 auto;
  }

  @media (max-width: 640px) {
    .ww2-crosslinks-grid {
      grid-template-columns: 1fr;
    }
  }

  .ww2-crosslink-card {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--space-2);
    padding: var(--space-5) var(--space-4);
    background: var(--color-white);
    border: 1px solid rgba(0, 0, 0, 0.06);
    border-radius: 16px;
    text-decoration: none;
    color: inherit;
    text-align: center;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }

  .ww2-crosslink-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
  }

  .ww2-crosslink-icon {
    font-size: 1.8rem;
  }

  .ww2-crosslink-label {
    font-size: 0.95rem;
    font-weight: var(--weight-bold);
    color: var(--color-deep-night);
  }

  .ww2-crosslink-desc {
    font-size: 0.78rem;
    color: var(--color-slate);
    line-height: 1.4;
  }

  /* ================================================================
     VIEW TOGGLE
     ================================================================ */
  .ww2-view-toggle {
    display: flex;
    justify-content: center;
    gap: 4px;
    background: var(--color-sand-dark);
    border-radius: 40px;
    padding: 4px;
    max-width: 240px;
    margin: 0 auto;
  }

  .ww2-toggle-btn {
    flex: 1;
    padding: 8px 20px;
    border: none;
    border-radius: 36px;
    font-size: 0.82rem;
    font-weight: var(--weight-semibold);
    cursor: pointer;
    background: transparent;
    color: var(--color-slate);
    transition: background 0.2s ease, color 0.2s ease;
  }

  .ww2-toggle-btn.active {
    background: var(--color-ocean-teal);
    color: #fff;
  }

  .ww2-toggle-btn:hover:not(.active) {
    color: var(--color-deep-night);
  }

  /* ================================================================
     MAP VIEW
     ================================================================ */
  .ww2-map-container {
    border-radius: 24px;
    position: relative;
    overflow: hidden;
    background: radial-gradient(ellipse at 40% 30%, #0c3547 0%, #091e2f 40%, #060f1a 100%);
    padding: 28px 20px 20px;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.35), inset 0 1px 0 rgba(255, 255, 255, 0.05);
    max-width: 600px;
    margin: 0 auto;
  }

  .ww2-map-container::before {
    content: '';
    position: absolute;
    inset: 0;
    background:
      radial-gradient(ellipse 600px 300px at 30% 70%, rgba(13, 115, 119, 0.08) 0%, transparent 70%),
      radial-gradient(ellipse 400px 200px at 70% 20%, rgba(13, 115, 119, 0.06) 0%, transparent 70%);
    animation: ww2OceanShimmer 8s ease-in-out infinite alternate;
    pointer-events: none;
  }

  .ww2-map-container::after {
    content: '';
    position: absolute;
    inset: 0;
    background-image:
      radial-gradient(circle 1px at 20% 30%, rgba(255, 255, 255, 0.03) 0%, transparent 100%),
      radial-gradient(circle 1px at 60% 50%, rgba(255, 255, 255, 0.02) 0%, transparent 100%),
      radial-gradient(circle 1px at 40% 80%, rgba(255, 255, 255, 0.02) 0%, transparent 100%);
    pointer-events: none;
  }

  @keyframes ww2OceanShimmer {
    0% { opacity: 0.5; }
    100% { opacity: 1; }
  }

  #ww2LeafletMap {
    width: 100%;
    height: 600px;
    border-radius: 16px;
    position: relative;
    z-index: 1;
  }

  .ww2-map-tooltip {
    position: absolute;
    background: rgba(26, 35, 50, 0.95);
    backdrop-filter: blur(12px);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 8px;
    padding: 10px 14px;
    pointer-events: none;
    opacity: 0;
    transform: translateY(4px);
    transition: opacity 0.2s ease, transform 0.2s ease;
    z-index: 50;
    min-width: 160px;
    max-width: 280px;
  }

  .ww2-map-tooltip.ww2-tooltip-visible {
    opacity: 1;
    transform: translateY(0);
  }

  .ww2-map-tooltip-title {
    font-size: 0.85rem;
    font-weight: var(--weight-bold);
    color: white;
    margin-bottom: 2px;
    line-height: 1.3;
  }

  .ww2-map-tooltip-date {
    font-size: 0.65rem;
    color: rgba(255, 255, 255, 0.45);
    font-weight: var(--weight-medium);
    text-transform: uppercase;
    letter-spacing: 0.06em;
    margin-bottom: 2px;
  }

  .ww2-map-tooltip-location {
    font-size: 0.72rem;
    color: var(--color-warm-coral);
    font-weight: var(--weight-medium);
  }

  .ww2-map-legend {
    display: flex;
    justify-content: center;
    gap: var(--space-5);
    padding: var(--space-3) var(--space-4);
    flex-wrap: wrap;
    position: relative;
    z-index: 1;
  }

  .ww2-map-legend-item {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 0.7rem;
    color: rgba(255, 255, 255, 0.45);
  }

  .ww2-map-legend-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    box-shadow: 0 0 6px rgba(13, 115, 119, 0.5);
  }

  @media (max-width: 768px) {
    #ww2LeafletMap { height: 450px; }
  }

  /* Personal intro */
  .ww2-personal {
    padding-block: var(--space-8);
  }

  .ww2-personal-quote {
    max-width: 680px;
    margin: 0 auto;
    padding: var(--space-6) var(--space-8);
    border-left: 4px solid var(--color-ocean-teal);
    background: var(--color-sky);
    border-radius: 0 12px 12px 0;
  }

  .ww2-personal-quote p {
    font-size: var(--text-body);
    color: var(--color-heading);
    line-height: var(--leading-body);
    font-style: italic;
    margin-bottom: var(--space-3);
  }

  .ww2-personal-quote cite {
    font-size: var(--text-caption);
    color: var(--color-ocean-teal);
    font-weight: var(--weight-semibold);
    font-style: normal;
  }
</style>
